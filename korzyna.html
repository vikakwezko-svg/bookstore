<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">
    <title>Bookstore</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .facebook{
           color: #000;
        }
        .facebook:hover{
            color: #5735d4;
        }
        .google{
           color: #000;
        }
        .google:hover{
            color: #0e661d;
        }
        .youtube{
           color: #000;
        }
        .youtube:hover{
            color: #c31010;
        }
        .instagram{
           color: #000;
        }
        .instagram:hover{
            color: #c310b7;
        }
        .twitter{
           color: #000;
        }
        .twitter:hover{
            color: #5f5b5e;
        }
    </style>
</head>
<body>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <img src="–ª–æ–≥–æ—Ç–∏–ø.png" alt="" width="150px" height="70px">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="index.html">Home</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Books
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <li><a class="dropdown-item" href="#"><h6>Categories</h6></a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="roman.html">–õ—é–±–æ–≤–Ω—ñ —Ä–æ–º–∞–Ω–∏</a></li>
                    <li><a class="dropdown-item" href="detektiv.html">–î–µ—Ç–µ–∫—Ç–∏–≤</a></li>
                    <li><a class="dropdown-item" href="fantastyka.html">–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞</a></li>
                    <li><a class="dropdown-item" href="kidslit.html">–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞</a></li>
                    </ul>
                <li class="nav-item">
                    <a class="nav-link" href="contacts.html">Contacts</a>
                </li>
            </div>
            <a class="nav-link" href="korzyna.html">
              <img src="./–∫–æ—Ä–∑–∏–Ω–∞.png" alt="Cart" width="45" height="45">
            </a>
        </div>
    </nav>

    <main class="container my-5">
        <h2 class="mb-4">–í–∞—à –∫–æ—à–∏–∫ üõí</h2>
        <div id="cart-items"></div>

        <div id="cart-total" class="mt-4 fs-5 fw-bold"></div> 
        <div class="mt-4 p-3 border rounded shadow-sm"> 
            <div class="d-flex align-items-center mb-3"> 
                <span class="fs-5 me-2 fw-semibold" id="converter-base-amount">0.00 –≥—Ä–Ω</span> 
                <label for="currency-select" class="form-label mb-0 me-2">–≤</label> 
                
               <select class="form-select w-auto me-3 selectpicker" id="currency-select" data-live-search="true" data-size="10"> 
                    <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –≤–∞–ª—é—Ç—É</option> 
                </select> 
                
                <button id="convert-btn" class="btn btn-secondary">–ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏</button> 
            </div> 
            <div id="converted-total" class="fs-5 fw-bold text-success"></div> 
        </div> 
        <button id="checkout-btn" class="btn btn-success mt-3">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>


        <div id="order-form-container" class="d-none mt-4">
            <div class="card shadow p-4 rounded-3">
                <h3 class="text-center mb-4">–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h3>
                <form id="order-form" class="needs-validation">
                    <h5 class="mb-3 fw-semibold">–û—Ç—Ä–∏–º—É–≤–∞—á</h5>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="lastName" class="form-label">–ü—Ä—ñ–∑–≤–∏—â–µ</label>
                            <input type="text" class="form-control" id="lastName" placeholder="–í–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ" required>
                        </div>
                        <div class="col-md-4">
                            <label for="firstName" class="form-label">–Ü–º‚Äô—è</label>
                            <input type="text" class="form-control" id="firstName" placeholder="–í–∞—à–µ —ñ–º‚Äô—è" required>
                        </div>
                        <div class="col-md-4">
                            <label for="middleName" class="form-label">–ü–æ –±–∞—Ç—å–∫–æ–≤—ñ</label>
                            <input type="text" class="form-control" id="middleName" placeholder="–ü–æ –±–∞—Ç—å–∫–æ–≤—ñ">
                        </div>
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-6">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" placeholder="name@example.com" required>
                        </div>
                        <div class="col-md-6">
                            <label for="phone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="0 xx xxx xxxx" required>
                        </div>
                    </div>

                    <h5 class="mt-4 mb-3 fw-semibold">–î–æ—Å—Ç–∞–≤–∫–∞</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="city" class="form-label">–ú—ñ—Å—Ç–æ</label>
                            <input type="text" class="form-control" id="city" placeholder="–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫" required>
                        </div>
                        <div class="col-md-6">
                            <label for="delivery" class="form-label">–°–ø–æ—Å—ñ–± –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                            <select class="form-select" id="delivery" required>
                                <option value="">–û–±–µ—Ä—ñ—Ç—å...</option>
                                <option value="nova poshta">–ù–æ–≤–∞ –ü–æ—à—Ç–∞</option>
                                <option value="ukr poshta">–£–∫—Ä–ø–æ—à—Ç–∞</option>
                            </select>
                        </div>
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-12">
                            <label for="branch" class="form-label">‚Ññ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è</label>
                            <input type="text" class="form-control" id="branch" placeholder="–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è ‚Ññ1: –≤—É–ª. –ú–∞–∫—Å–∏–º–æ–≤–∏—á–∞, 8" required>
                        </div>
                    </div>

                    <h5 class="mt-4 mb-3 fw-semibold">–û–ø–ª–∞—Ç–∞</h5>
                    <div class="d-flex flex-column flex-sm-row gap-3">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payment" id="payment-online" value="online" required >
                            <label class="form-check-label" for="payment-online">–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–∫–æ—é –æ–Ω–ª–∞–π–Ω</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payment" id="payment-cash" value="cash">
                            <label class="form-check-label" for="payment-cash">–û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ</label>
                        </div>
                    </div>

                    <div id="form-total" class="mt-4 mb-3 fw-bold text-end fs-5 text-dark"></div>

                    <div class="d-flex justify-content-end gap-3 mt-3">
                        <button type="button" class="btn btn-danger" id="cancel-order">–í—ñ–¥–º—ñ–Ω–∏—Ç–∏</button>
                        <button type="submit" class="btn btn-success">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
                    </div>
                </form>
            </div>
        </div>
    </main>


    <footer class="bg-light p-5">
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-auto">
                    <a href="index.html">
                        <img src="–ª–æ–≥–æ—Ç–∏–ø.png" alt="img">
                    </a>
                </div>
            </div>
            <div class="row justify-content-center mt-2">
                <div class="col-auto text-center">
                    –ö–Ω–∏–≥–∏ ‚Äì —Ü–µ —Ä—ñ–∫–∏, —â–æ –Ω–∞–ø–æ—é—é—Ç—å –º–æ—Ä—è.
                </div>
            </div>
            <div class="row justify-content-center mt-3">
                <div class="col-auto" >
                    <a href="https://www.facebook.com/?locale=uk_UA" target="_blank" class="facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
                            <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"/>
                        </svg>
                    </a>
                </div>
                <div class="col-auto">
                    <a href="https://www.google.com.ua/?hl=uk" target="_blank" class="google">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-google" viewBox="0 0 16 16">
                            <path d="M15.545 6.558a9.4 9.4 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.7 7.7 0 0 1 5.352 2.082l-2.284 2.284A4.35 4.35 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.8 4.8 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.7 3.7 0 0 0 1.599-2.431H8v-3.08z"/>
                        </svg>
                    </a>
                </div>
                <div class="col-auto">
                    <a href="https://www.youtube.com/?hl=uk&gl=UA&app=desktop" target="_blank" class="youtube">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-youtube" viewBox="0 0 16 16">
                            <path d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.01 2.01 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.01 2.01 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31 31 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.01 2.01 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A100 100 0 0 1 7.858 2zM6.4 5.209v4.818l4.157-2.408z"/>
                        </svg>
                    </a>
                </div>
                <div class="col-auto">
                    <a href="https://www.instagram.com/accounts/login/?next=%2Fomdop%2Ffeed%2F&source=profile_feed_tab&locale=ru" target="_blank" class="instagram">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16">
                            <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"/>
                        </svg>
                    </a>
                </div>
                <div class="col-auto">
                    <a href="https://twitter.com/?lang=uk" target="_blank" class="twitter">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-twitter-x" viewBox="0 0 16 16">
                            <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/>
                        </svg>
                    </a>
                </div>
            </div>
            <hr class="my-4">
            <div class="row justify-content-between">
                <div class="col-auto">
                    Copyright <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-c-circle" viewBox="0 0 16 16">
                        <path d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.146 4.992c-1.212 0-1.927.92-1.927 2.502v1.06c0 1.571.703 2.462 1.927 2.462.979 0 1.641-.586 1.729-1.418h1.295v.093c-.1 1.448-1.354 2.467-3.03 2.467-2.091 0-3.269-1.336-3.269-3.603V7.482c0-2.261 1.201-3.638 3.27-3.638 1.681 0 2.935 1.054 3.029 2.572v.088H9.875c-.088-.879-.768-1.512-1.729-1.512"/>
                      </svg> kvetsko.v
                </div>
                <div class="col-auto">
                    <img width="40px" class="mx-1" src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg" alt="MasterCard">
                    <img width="40px" class="mx-1" src="https://www.visa.com.ua/content/dam/VCOM/global/about-visa/images/visa-brandmark-blue-1960x622.png" alt="Visa">
                    <img width="40px" class="mx-1" src="https://cdn.worldvectorlogo.com/logos/cirrus-logo.svg" alt="Cirrus">
                    <img width="40px" class="mx-1" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/2560px-PayPal.svg.png" alt="PayPal">
                </div>
            </div>
        </div>
    </footer>
    
  
<iframe name="hidden_iframe" style="display:none;"></iframe>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>¬†

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/i18n/defaults-ua_UA.min.js"></script>
    
   <script>
// –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
let currentTotalAmount = 0;
let currentCurrency = 'UAH';
let allCurrencies = {}; 
let isConverted = false; 

const API_URL = 'https://open.er-api.com/v6/latest/UAH'; 

// ** –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –≤–∞–ª—é—Ç —Ç–∞ –∫—É—Ä—Å—ñ–≤ **
async function loadCurrencyList() {
    const select = document.getElementById('currency-select');
    try {
        const response = await fetch(API_URL);
        const data = await response.json();
        
        if (data.result == 'success') {
            allCurrencies = data.rates;
            select.innerHTML = ''; 
            for (const code in allCurrencies) {
                const option = document.createElement('option');
                option.value = code;
                option.textContent = code; 
                select.appendChild(option);
            }
            
            // ‚úÖ –ö–õ–Æ–ß–û–í–ò–ô –ö–†–û–ö: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è Selectpicker
            $(select).selectpicker('refresh'); 
        }
    } catch (error) {
        console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –≤–∞–ª—é—Ç:", error);
        
        // –§–æ–ª–ª–±–µ–∫
        select.innerHTML = '<option value="UAH" selected>UAH</option><option value="USD">USD</option><option value="EUR">EUR</option>';
        // ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è Selectpicker —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏
        $(select).selectpicker('refresh');
    }
}

// ** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É –∫–æ—à–∏–∫–∞ **
async function renderCart() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartContainer = document.getElementById('cart-items');
    const totalContainer = document.getElementById('cart-total');
    const formTotalElement = document.getElementById('form-total'); 
    const convertedContainer = document.getElementById('converted-total');
    const converterBaseAmount = document.getElementById('converter-base-amount');
    const converterBlock = document.querySelector('.mt-4.p-3.border.rounded.shadow-sm');
    
    cartContainer.innerHTML = '';
    
    const totalUAH = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);

    if (cart.length == 0) {
        // –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –∫–æ—à–∏–∫–∞
        cartContainer.innerHTML = '<p>–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π üòî</p>';
        totalContainer.textContent = '';
        convertedContainer.textContent = '';
        if (formTotalElement) formTotalElement.textContent = '';
        
        if (converterBlock) converterBlock.style.display = 'none';
        
        currentTotalAmount = 0;
        currentCurrency = 'UAH';
        isConverted = false;
        return;
    }
    
    // –ü–æ–∫–∞–∑—É—î–º–æ –±–ª–æ–∫ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞
    if (converterBlock) converterBlock.style.display = 'block';

    if (!isConverted || currentTotalAmount == 0) { 
        currentTotalAmount = totalUAH; 
        currentCurrency = 'UAH';
        convertedContainer.textContent = ''; // –û—á–∏—â–∞—î–º–æ, —è–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—è –¥–æ UAH
    }

    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∫–æ—à–∏–∫–∞
    cart.forEach((item, index) => {
        const cartItem = document.createElement('div');
        cartItem.classList.add('d-flex', 'align-items-center', 'mb-3', 'border-bottom', 'pb-3');
        cartItem.innerHTML = `
            <img src="${item.image}" alt="${item.title}" width="80" class="me-3 rounded">
            <div class="flex-grow-1">
                <h5>${item.title}</h5>
                <p class="mb-1">–¶—ñ–Ω–∞: ${item.price} –≥—Ä–Ω</p>
                <div class="d-flex align-items-center">
                    <label class="me-2">–ö—ñ–ª—å–∫—ñ—Å—Ç—å:</label>
                    <input type="number" min="1" value="${item.quantity}" class="form-control w-auto" id="qty-${index}">
                    <button class="btn btn-danger btn-sm ms-3 remove-item" data-index="${index}">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                </div>
            </div>
        `;
        cartContainer.appendChild(cartItem);
        
        // –§—É–Ω–∫—Ü—ñ—è —Å–∫–∏–¥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –ø—Ä–∏ –∑–º—ñ–Ω—ñ –∫–æ—à–∏–∫–∞
        const updateCartAndResetConversion = () => {
            isConverted = false; // –°–∫–∏–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å, –±–æ —Å—É–º–∞ UAH –∑–º—ñ–Ω–∏–ª–∞—Å—è
            convertedContainer.textContent = ''; 
            renderCart();
        };

       
document.getElementById('convert-btn').addEventListener('click', handleConvert);

        // –û–±—Ä–æ–±–Ω–∏–∫ –∑–º—ñ–Ω–∏ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
        cartItem.querySelector(`#qty-${index}`).addEventListener('change', e => {
            cart[index].quantity = parseInt(e.target.value);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartAndResetConversion();
        });

        // –û–±—Ä–æ–±–Ω–∏–∫ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
        cartItem.querySelector('.remove-item').addEventListener('click', (e) => {
            const clickedIndex = parseInt(e.currentTarget.dataset.index);
            cart.splice(clickedIndex, 1);
            
            if (cart.length == 0) {
                localStorage.removeItem('cart');
            } else {
                localStorage.setItem('cart', JSON.stringify(cart));
            }
            updateCartAndResetConversion();
        });
    });

    // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—É–º–∏
    totalContainer.textContent = `–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: ${totalUAH.toFixed(2)} –≥—Ä–Ω`;
    
    if (converterBaseAmount) {
         converterBaseAmount.textContent = `${totalUAH.toFixed(2)} –≥—Ä–Ω`;
    }

    // –û–Ω–æ–≤–ª—é—î–º–æ –∑–∞–≥–∞–ª—å–Ω—É —Å—É–º—É —É —Ñ–æ—Ä–º—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
    if (formTotalElement) {
        formTotalElement.textContent = `–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è: ${currentTotalAmount.toFixed(2)} ${currentCurrency}`;
    }
}

// ** –§—É–Ω–∫—Ü—ñ—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó **
async function handleConvert() {
    const totalUAH = (JSON.parse(localStorage.getItem('cart')) || []).reduce((sum, item) => sum + item.price * item.quantity, 0);
    const targetCurrency = document.getElementById('currency-select').value;
    const convertedContainer = document.getElementById('converted-total');
    
    if (totalUAH == 0 || !targetCurrency || targetCurrency == '–û–±–µ—Ä—ñ—Ç—å –≤–∞–ª—é—Ç—É') {
        const msg = totalUAH == 0 ? '‚ùå –ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.' : '‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –≤–∞–ª—é—Ç—É.';
        convertedContainer.textContent = msg;
        convertedContainer.classList.remove('text-success');
        convertedContainer.classList.add('text-danger');
        isConverted = false; 
        return;
    }
    
    convertedContainer.textContent = '... –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è ...';
    convertedContainer.classList.remove('text-danger');
    convertedContainer.classList.add('text-success');
    
    if (targetCurrency == 'UAH') {
        currentTotalAmount = totalUAH;
        currentCurrency = 'UAH';
        isConverted = false; // –°–∫–∏–¥–∞—î–º–æ, —è–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—è –¥–æ UAH
        convertedContainer.textContent = `–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: ${totalUAH.toFixed(2)} –≥—Ä–Ω`;
        
    } else {
        try {
            const rate = allCurrencies[targetCurrency];
            
            if (!rate) {
                 throw new Error(`–ö—É—Ä—Å –¥–ª—è ${targetCurrency} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.`);
            }
            
            const convertedAmount = totalUAH * rate;
            
            isConverted = true; 
            currentTotalAmount = convertedAmount;
            currentCurrency = targetCurrency;
            
            convertedContainer.textContent = `–ö–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∞ —Å—É–º–∞: ${convertedAmount.toFixed(2)} ${targetCurrency}`;
            
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó:", error);
            convertedContainer.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞: –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫—É—Ä—Å.';
            convertedContainer.classList.remove('text-success');
            convertedContainer.classList.add('text-danger');
            isConverted = false;
        }
    }
    
    // –û–Ω–æ–≤–ª—é—î–º–æ –∑–∞–≥–∞–ª—å–Ω—É —Å—É–º—É —É —Ñ–æ—Ä–º—ñ –ø—ñ—Å–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó
    const formTotalElement = document.getElementById('form-total');
    if (formTotalElement) {
        formTotalElement.textContent = `–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è: ${currentTotalAmount.toFixed(2)} ${currentCurrency}`;
    }
}

// ** –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π **

document.getElementById('convert-btn').addEventListener('click', handleConvert);

document.getElementById('checkout-btn').addEventListener('click', async () => {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    if(cart.length == 0){
        alert('–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π!');
        return;
    }
    
    // –í–∏–∫–ª–∏–∫ renderCart() –æ–Ω–æ–≤–∏—Ç—å —Å—É–º—É, —è–∫—â–æ –≤–æ–Ω–∞ –Ω—É–ª—å–æ–≤–∞
    await renderCart(); 
    
    if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –æ—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?')) {
        document.getElementById('order-form-container').classList.remove('d-none');
    }
});

document.getElementById('order-form').addEventListener('submit', function(e){
    e.preventDefault(); 
    
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    if(cart.length == 0){
        alert('–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π!');
        return;
    }
    
    // ... (–õ–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—ó —Ñ–æ—Ä–º–∏) ...
    let hiddenForm = document.getElementById('orderForm');
    if(!hiddenForm){
        hiddenForm = document.createElement('form');
        hiddenForm.id = 'orderForm';
        hiddenForm.target = 'hidden_iframe';
        hiddenForm.method = 'POST';
        hiddenForm.action = 'https://script.google.com/macros/s/AKfycbxYFBu0qhJYv814LgGBqolFnBIjk_p_O8623IJ8j8GOAdcUrNf-Hn-nIoTzGOVXrXQQuA/exec';
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'order';
        input.id = 'orderData';
        hiddenForm.appendChild(input);
        document.body.appendChild(hiddenForm);
    }
    
    const totalUAH = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);

    const orderData = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        middleName: document.getElementById('middleName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        city: document.getElementById('city').value,
        delivery: document.getElementById('delivery').value,
        branch: document.getElementById('branch').value,
        payment: document.querySelector('input[name="payment"]:checked')?.value,
        
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        finalAmount: currentTotalAmount.toFixed(2), 
        finalCurrency: currentCurrency, 
        totalUAH: totalUAH.toFixed(2),
        
        cart
    };

    document.getElementById('orderData').value = JSON.stringify(orderData);

    alert('‚úÖ –í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –æ—Ñ–æ—Ä–º–ª—è—î—Ç—å—Å—è...');
    setTimeout(() => {
        alert('üéâ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–µ! –î—è–∫—É—î–º–æ üíö');
        localStorage.removeItem('cart');
        document.getElementById('order-form').reset();
        document.getElementById('order-form-container').classList.add('d-none');
        renderCart(); 
    }, 1500);

    hiddenForm.submit();
});

document.getElementById('cancel-order').addEventListener('click', () => {
    document.getElementById('order-form-container').classList.add('d-none');
});

// –ó–∞–ø—É—Å–∫
loadCurrencyList();   
renderCart();
</script>

</body>
</html>    



















































